{% extends 'base.html' %}
{% load static %}

{% block register %}

<style>
    .container-register{
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 40px 0px; 
    }

    .box-register{
        width: 23%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        border: 1px solid #d5a12c;
        padding: 30px;
        border-radius: 3px;
        box-shadow: 0px 0px 3px 2px #d5a12c;


    }

    .register-title{
        font-size: 28px;
        font-weight: 1000;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    input {
        width: 100%;
        margin: 10px 0;
        padding: 5px 10px;
        color: #d5a12c;
        text-shadow: 1px 1px 1px #000;
        outline-color: #cdc197;
        box-shadow: 0px 0px 3px 2px #d5a12c;
        border: 1px solid #d5a12c;
        border-radius: 3px;
    }

    .box-btn-register{
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        padding-top: 30px;
        

    }

    
    .btn-register{
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 5px ;
        min-width: 130px;
        font-weight: bold;
        border: 2px solid #d5a12c;
        box-shadow: 0px 0px 0px 3px #cdc197;
        border-radius: 3px;
        cursor: pointer;
        background-color: transparent;
        color: #d5a12c;
        text-shadow: 1px 1px 1px #000;
    }

</style>

<div class="container-register">
    
    <form id="register-form" class="box-register">
        <span class="register-title">Đăng Ký</span>
        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" required>
        </div>
        <div>
            <label for="username">Tên người dùng:</label>
            <input type="text" id="username" required>
        </div>
        <div>
            <label for="password">Mật khẩu:</label>
            <input type="password" id="password" required>
        </div>
        <div>
            <label for="phone">Số điện thoại:</label>
            <input type="text" id="phone" required>
        </div>

        <div class="box-btn-register">
            <button type="submit" class="btn-register">Đăng Ký</button>
        </div>
        <div id="response-message"></div>
    </form>
    
</div>

<script>
    document.getElementById('register-form').addEventListener('submit', function (event) {
        event.preventDefault();

        const email = document.getElementById('email').value;
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const phone = document.getElementById('phone').value;

        fetch('/api/register/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                email: email,
                username: username,
                password: password,
                phone: phone
            }),
        })
        .then(response => response.json())
        .then(data => {
            const messageElement = document.getElementById('response-message');
            if (data.message) {
                messageElement.innerHTML = `<div class="alert alert-success">${data.message}</div>`;
                // Chuyển hướng đến trang đăng nhập
                window.location.href = '/login/';
            } else if (data.error_messages) {
                messageElement.innerHTML = `<div class="alert alert-danger">${data.error_messages.email || data.error_messages.username || 'Có lỗi xảy ra.'}</div>`;
            }
        })
        .catch(error => {
            console.error('Error:', error);
        });
    });
</script>

<style>
    .container {
        max-width: 500px;
        margin: auto;
        padding: 20px;
    }
    .form-control {
        margin-bottom: 15px;
    }
</style>
{% endblock register %}